<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä»é›¶æ­å»ºä¸€ä¸ªReacté¡¹ç›® | å‰ç«¯å¼€å‘æ‰‹å†Œ</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="å‰ç«¯å¼€å‘æ‰‹å†Œï¼Œæ‰“é€ å®Œå–„çš„çŸ¥è¯†ä½“ç³»">
    <link rel="preload" href="/dist/assets/css/0.styles.212cc1b5.css" as="style"><link rel="preload" href="/dist/assets/js/app.c45fc4d8.js" as="script"><link rel="preload" href="/dist/assets/js/2.7c6cafdd.js" as="script"><link rel="preload" href="/dist/assets/js/5.60462f69.js" as="script"><link rel="prefetch" href="/dist/assets/js/10.c582f032.js"><link rel="prefetch" href="/dist/assets/js/11.3ffb7d2e.js"><link rel="prefetch" href="/dist/assets/js/12.7a486774.js"><link rel="prefetch" href="/dist/assets/js/13.2769eb06.js"><link rel="prefetch" href="/dist/assets/js/14.c1913f78.js"><link rel="prefetch" href="/dist/assets/js/15.913f7b82.js"><link rel="prefetch" href="/dist/assets/js/16.a17af60c.js"><link rel="prefetch" href="/dist/assets/js/17.c496297c.js"><link rel="prefetch" href="/dist/assets/js/18.000625cf.js"><link rel="prefetch" href="/dist/assets/js/19.b4e91d39.js"><link rel="prefetch" href="/dist/assets/js/3.a2ae1510.js"><link rel="prefetch" href="/dist/assets/js/4.0640617f.js"><link rel="prefetch" href="/dist/assets/js/6.27dd2ddc.js"><link rel="prefetch" href="/dist/assets/js/7.d7ae11ea.js"><link rel="prefetch" href="/dist/assets/js/8.1754cb45.js"><link rel="prefetch" href="/dist/assets/js/9.a0e27dca.js">
    <link rel="stylesheet" href="/dist/assets/css/0.styles.212cc1b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dist/" class="home-link router-link-active"><!----> <span class="site-name">å‰ç«¯å¼€å‘æ‰‹å†Œ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Css" class="dropdown-title"><span class="title">Css</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/Css/" class="nav-link">
  cssæ–‡å­—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä»£ç å—" class="dropdown-title"><span class="title">ä»£ç å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/Utils/" class="nav-link">
  æ’ä»¶ç³»åˆ—
</a></li><li class="dropdown-item"><!----> <a href="/dist/Utils/image.html" class="nav-link">
  å›¾ç‰‡ç³»åˆ—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®æ­å»º" class="dropdown-title"><span class="title">é¡¹ç›®æ­å»º</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/React/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  React
</a></li><li class="dropdown-item"><!----> <a href="/dist/Vue/" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><a href="/dist/Three.js/" class="nav-link">
  Three.js
</a></div> <a href="https://github.com/gaohongwei11" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Css" class="dropdown-title"><span class="title">Css</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/Css/" class="nav-link">
  cssæ–‡å­—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä»£ç å—" class="dropdown-title"><span class="title">ä»£ç å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/Utils/" class="nav-link">
  æ’ä»¶ç³»åˆ—
</a></li><li class="dropdown-item"><!----> <a href="/dist/Utils/image.html" class="nav-link">
  å›¾ç‰‡ç³»åˆ—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®æ­å»º" class="dropdown-title"><span class="title">é¡¹ç›®æ­å»º</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dist/React/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  React
</a></li><li class="dropdown-item"><!----> <a href="/dist/Vue/" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><a href="/dist/Three.js/" class="nav-link">
  Three.js
</a></div> <a href="https://github.com/gaohongwei11" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ä»é›¶æ­å»ºä¸€ä¸ªReacté¡¹ç›®</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dist/React/#create-react-app" class="sidebar-link">create-react-app</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#åˆå§‹åŒ–" class="sidebar-link">åˆå§‹åŒ–</a></li><li class="sidebar-sub-header"><a href="/dist/React/#ç›®å½•ç»“æ„è°ƒæ•´" class="sidebar-link">ç›®å½•ç»“æ„è°ƒæ•´</a></li></ul></li><li><a href="/dist/React/#å¼•å…¥-antd-mobile" class="sidebar-link">å¼•å…¥ antd-mobile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#å®‰è£…" class="sidebar-link">å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/dist/React/#åŸºæœ¬åº”ç”¨" class="sidebar-link">åŸºæœ¬åº”ç”¨</a></li></ul></li><li><a href="/dist/React/#ä½¿ç”¨-sass" class="sidebar-link">ä½¿ç”¨ Sass</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dist/React/#ä½¿ç”¨-fastclick" class="sidebar-link">ä½¿ç”¨ Fastclick</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/dist/React/#vwé€‚é…" class="sidebar-link">vwé€‚é…</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#å®‰è£…-2" class="sidebar-link">å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/dist/React/#é…ç½®" class="sidebar-link">é…ç½®</a></li><li class="sidebar-sub-header"><a href="/dist/React/#vwå…¼å®¹æ–¹æ¡ˆ" class="sidebar-link">vwå…¼å®¹æ–¹æ¡ˆ</a></li></ul></li><li><a href="/dist/React/#setupproxy" class="sidebar-link">setupProxy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#å®‰è£…-http-proxy-middleware" class="sidebar-link">å®‰è£… http-proxy-middleware</a></li><li class="sidebar-sub-header"><a href="/dist/React/#é…ç½®ä»£ç†" class="sidebar-link">é…ç½®ä»£ç†</a></li></ul></li><li><a href="/dist/React/#api" class="sidebar-link">Api</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#æ¥å£" class="sidebar-link">æ¥å£</a></li><li class="sidebar-sub-header"><a href="/dist/React/#axioså°è£…" class="sidebar-link">axioså°è£…</a></li></ul></li><li><a href="/dist/React/#ä½¿ç”¨-router-è·¯ç”±" class="sidebar-link">ä½¿ç”¨ Router(è·¯ç”±)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#å®‰è£…-3" class="sidebar-link">å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/dist/React/#åŸºæœ¬åº”ç”¨-2" class="sidebar-link">åŸºæœ¬åº”ç”¨</a></li></ul></li><li><a href="/dist/React/#ä½¿ç”¨-redux-çŠ¶æ€ç®¡ç†" class="sidebar-link">ä½¿ç”¨ Redux(çŠ¶æ€ç®¡ç†)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dist/React/#å®‰è£…-4" class="sidebar-link">å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/dist/React/#åŸºæœ¬åº”ç”¨-3" class="sidebar-link">åŸºæœ¬åº”ç”¨</a></li></ul></li><li><a href="/dist/React/#æœ€å" class="sidebar-link">æœ€å ğŸ“Œ</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ä»é›¶æ­å»ºä¸€ä¸ªreacté¡¹ç›®"><a href="#ä»é›¶æ­å»ºä¸€ä¸ªreacté¡¹ç›®" class="header-anchor">#</a> ä»é›¶æ­å»ºä¸€ä¸ªReacté¡¹ç›®</h1> <h2 id="create-react-app"><a href="#create-react-app" class="header-anchor">#</a> create-react-app</h2> <p><code>create-react-app</code> æ˜¯ä¸€ä¸ªå®˜æ–¹æ”¯æŒçš„åˆ›å»º <code>React</code> å•é¡µåº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚<br>
å®ƒæä¾›äº†ä¸€ä¸ªé›¶é…ç½®çš„ç°ä»£æ„å»ºè®¾ç½®ã€‚</p> <h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="header-anchor">#</a> åˆå§‹åŒ–</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>npx create-react-app my-app  
<span class="token builtin class-name">cd</span> my-app  
<span class="token function">npm</span> start  
</code></pre></div><p><img src="/dist/assets/img/screencast.c5721b6d.svg" alt=""></p> <h3 id="ç›®å½•ç»“æ„è°ƒæ•´"><a href="#ç›®å½•ç»“æ„è°ƒæ•´" class="header-anchor">#</a> ç›®å½•ç»“æ„è°ƒæ•´</h3> <p>ä¸‹é¢æ˜¯<code>create-react-app</code>ç”Ÿæˆçš„ç›®å½•ç»“æ„</p> <div class="language- extra-class"><pre class="language-text"><code>my-app
â”œâ”€â”€ README.md
â”œâ”€â”€ node_modules
â”œâ”€â”€ package.json
â”œâ”€â”€ .gitignore
â”œâ”€â”€ public
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ manifest.json
â””â”€â”€ src
    â”œâ”€â”€ App.css
    â”œâ”€â”€ App.js
    â”œâ”€â”€ App.test.js
    â”œâ”€â”€ index.css
    â”œâ”€â”€ index.js
    â”œâ”€â”€ logo.svg
    â””â”€â”€ serviceWorker.js
</code></pre></div><p>æˆ‘ä»¬éœ€è¦ç®€å•è°ƒæ•´ä¸€ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code>my<span class="token operator">-</span>app
â”œâ”€â”€ <span class="token constant">README</span><span class="token punctuation">.</span>md
â”œâ”€â”€ node_modules
â”œâ”€â”€ <span class="token keyword">package</span><span class="token punctuation">.</span>json
â”œâ”€â”€ <span class="token punctuation">.</span>gitignore
â”œâ”€â”€ <span class="token keyword">public</span>
â”‚   â”œâ”€â”€ favicon<span class="token punctuation">.</span>ico
â”‚   â”œâ”€â”€ index<span class="token punctuation">.</span>html
â”‚   â””â”€â”€ manifest<span class="token punctuation">.</span>json
â””â”€â”€ src
    â”œâ”€â”€ assets <span class="token comment">// èµ„æº</span>
    â”‚    â”œâ”€â”€ style
    â”‚    â””â”€â”€ images
    â”œâ”€â”€ component <span class="token comment">// ç»„ä»¶</span>
    â”‚    â”œâ”€â”€ header
    â”‚    â””â”€â”€ footer
    â”œâ”€â”€ pages  <span class="token comment">// é¡µé¢</span>
    â”‚    â”œâ”€â”€ home
    â”‚    â”‚    â”œâ”€â”€ home<span class="token punctuation">.</span>jsx
    â”‚    â”‚    â””â”€â”€ home<span class="token punctuation">.</span>scss
    â”‚    â”œâ”€â”€ detail
    â”‚    â”‚    â”œâ”€â”€ detail<span class="token punctuation">.</span>jsx
    â”‚    â”‚    â””â”€â”€ detail<span class="token punctuation">.</span>scss
    â”‚    â””â”€â”€ list
    â”‚        â”œâ”€â”€ list<span class="token punctuation">.</span>jsx
    â”‚        â””â”€â”€ list<span class="token punctuation">.</span>scss
    â”œâ”€â”€ utils <span class="token comment">// å·¥å…· </span>
    â”œâ”€â”€ index<span class="token punctuation">.</span>js
    â””â”€â”€ serviceWorker<span class="token punctuation">.</span>js
</code></pre></div><h2 id="å¼•å…¥-antd-mobile"><a href="#å¼•å…¥-antd-mobile" class="header-anchor">#</a> å¼•å…¥ antd-mobile</h2> <h3 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> antd-mobile --save
</code></pre></div><h3 id="åŸºæœ¬åº”ç”¨"><a href="#åŸºæœ¬åº”ç”¨" class="header-anchor">#</a> åŸºæœ¬åº”ç”¨</h3> <p>å¼•å…¥ <code>react-app-rewired</code> å¹¶ä¿®æ”¹ <code>package.json</code> é‡Œçš„å¯åŠ¨é…ç½®ã€‚ç”±äºæ–°çš„ <code>react-app-rewired@2.x</code> ç‰ˆæœ¬çš„å…³ç³»ï¼Œä½ è¿˜éœ€è¦å®‰è£… <code>customize-cra</code>ã€‚</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> react-app-rewired customize-cra --save-dev
</code></pre></div><div class="language-json extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><div class="highlighted">Â </div><br><div class="highlighted">Â </div><br><br></div><pre class="language-json"><code><span class="token comment">/* package.json */</span>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
-   <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-scripts start&quot;</span><span class="token punctuation">,</span>
+   <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-app-rewired start&quot;</span><span class="token punctuation">,</span>
-   <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-scripts build&quot;</span><span class="token punctuation">,</span>
+   <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-app-rewired build&quot;</span><span class="token punctuation">,</span>
-   <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-scripts test --env=jsdom&quot;</span><span class="token punctuation">,</span>
+   <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-app-rewired test --env=jsdom&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª config-overrides.js ç”¨äºä¿®æ”¹é»˜è®¤é…ç½®ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">override</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do stuff with the webpack config...</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ä½¿ç”¨ <code>babel-plugin-import</code>, <code>babel-plugin-import</code> æ˜¯ä¸€ä¸ªç”¨äºæŒ‰éœ€åŠ è½½ç»„ä»¶ä»£ç å’Œæ ·å¼çš„ <code>babel</code> æ’ä»¶ï¼ˆåŸç†ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬å°è¯•å®‰è£…å®ƒå¹¶ä¿®æ”¹ <code>config-overrides.js</code> æ–‡ä»¶ã€‚</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> babel-plugin-import --save-dev
</code></pre></div><div class="language-js extra-class"><div class="highlight-lines"><div class="highlighted">Â </div><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br></div><pre class="language-js"><code><span class="token operator">+</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> override<span class="token punctuation">,</span> fixBabelImports <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'customize-cra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">-</span> module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">override</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">-</span>   <span class="token comment">// do stuff with the webpack config...</span>
<span class="token operator">-</span>   <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">+</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">override</span><span class="token punctuation">(</span>
<span class="token operator">+</span>   <span class="token function">fixBabelImports</span><span class="token punctuation">(</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
<span class="token operator">+</span>     libraryName<span class="token operator">:</span> <span class="token string">'antd-mobile'</span><span class="token punctuation">,</span>
<span class="token operator">+</span>     style<span class="token operator">:</span> <span class="token string">'css'</span><span class="token punctuation">,</span>
<span class="token operator">+</span>   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token operator">+</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¼•ç”¨æ–¹å¼</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd-mobile'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ä½¿ç”¨-sass"><a href="#ä½¿ç”¨-sass" class="header-anchor">#</a> ä½¿ç”¨ Sass</h2> <p>å®‰è£… <code>node-sass</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> node-sass --save
<span class="token comment"># or</span>
<span class="token function">yarn</span> <span class="token function">add</span> node-sass
</code></pre></div><p>ç°åœ¨ä½ å¯ä»¥å°† <code>src/pages/home.css</code> é‡å‘½åä¸º <code>src/pages/home.scss</code></p> <h2 id="ä½¿ç”¨-fastclick"><a href="#ä½¿ç”¨-fastclick" class="header-anchor">#</a> ä½¿ç”¨ Fastclick</h2> <p>ç§»åŠ¨è®¾å¤‡ä¸Šçš„æµè§ˆå™¨é»˜è®¤ä¼šåœ¨ç”¨æˆ·ç‚¹å‡»å±å¹•å¤§çº¦å»¶è¿Ÿ300æ¯«ç§’åæ‰ä¼šè§¦å‘ç‚¹å‡»äº‹ä»¶</p> <p>å®‰è£…</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> fastclick --save
</code></pre></div><p>ä½¿ç”¨</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> FastClick <span class="token keyword">from</span> <span class="token string">'fastclick'</span><span class="token punctuation">;</span>

FastClick<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="vwé€‚é…"><a href="#vwé€‚é…" class="header-anchor">#</a> vwé€‚é…</h2> <p>å‚è€ƒæ‰‹æ·˜å¤§æ¼ è€å¸ˆçš„vwé€‚é…æ–¹æ¡ˆï¼š<a href="https://www.w3cplus.com/mobile/vw-layout-in-vue.html" target="_blank" rel="noopener noreferrer">å¦‚ä½•åœ¨Vueé¡¹ç›®ä¸­ä½¿ç”¨vwå®ç°ç§»åŠ¨ç«¯é€‚é…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,åšä¸€ä¸ªReactç‰ˆæœ¬çš„vwå¸ƒå±€æ–¹æ¡ˆã€‚</p> <p>å¯¹äºFlexibleæˆ–è€…è¯´vwçš„å¸ƒå±€ï¼Œå…¶åŸç†ä¸åœ¨è¿™ç¯‡æ–‡ç« è¿›è¡Œé˜è¿°ã€‚å¦‚æœä½ æƒ³è¿½è¸ªå…¶ä¸­çš„åŸå§”ï¼Œå¼ºçƒˆå»ºè®®ä½ é˜…è¯»æ—©å‰æ•´ç†çš„æ–‡ç« ã€Š<a href="https://www.w3cplus.com/mobile/lib-flexible-for-html5-layout.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨Flexibleå®ç°æ‰‹æ·˜H5é¡µé¢çš„ç»ˆç«¯é€‚é…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‹å’Œã€Š<a href="https://www.w3cplus.com/css/vw-for-layout.html" target="_blank" rel="noopener noreferrer">å†èŠç§»åŠ¨ç«¯é¡µé¢çš„é€‚é…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‹ã€‚</p> <h3 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="header-anchor">#</a> å®‰è£…</h3> <ul><li><code>postcss-aspect-ratio-mini</code></li> <li><code>postcss-px-to-viewport</code></li> <li><code>postcss-write-svg</code></li> <li><code>postcss-cssnext</code></li> <li><code>postcss-viewport-units</code></li> <li><code>cssnano</code></li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i postcss-aspect-ratio-mini postcss-px-to-viewport postcss-write-svg postcss-cssnext postcss-viewport-units cssnano --S   
</code></pre></div><p>åœ¨<code>cssnano</code>çš„é…ç½®ä¸­ï¼Œä½¿ç”¨äº†<code>preset: &quot;advanced&quot;</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¦å¤–å®‰è£…ï¼š</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i cssnano-preset-advanced --save-dev  
</code></pre></div><h3 id="é…ç½®"><a href="#é…ç½®" class="header-anchor">#</a> é…ç½®</h3> <p>è¿˜è®°å¾—æ ¹ç›®å½•ä¸‹çš„ <code>config-overrides.js</code> å—ï¼Ÿï¼Œæˆ‘ä»¬æ¥ç€ä¸ºvwé€‚é…æ·»åŠ é…ç½®ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> override<span class="token punctuation">,</span> fixBabelImports<span class="token punctuation">,</span> addLessLoader<span class="token punctuation">,</span> addWebpackAlias<span class="token punctuation">,</span> addPostcssPlugins <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'customize-cra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">override</span><span class="token punctuation">(</span>
    <span class="token function">fixBabelImports</span><span class="token punctuation">(</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        libraryName<span class="token operator">:</span> <span class="token string">'antd-mobile'</span><span class="token punctuation">,</span>
        style<span class="token operator">:</span> <span class="token string">'css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">addLessLoader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        javascriptEnabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        modifyVars<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">'@primary-color'</span><span class="token operator">:</span><span class="token string">'#1DA57A'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">addWebpackAlias</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token string">'@'</span><span class="token punctuation">]</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">addPostcssPlugins</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-import'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-url'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-flexbugs-fixes'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-preset-env'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            autoprefixer<span class="token operator">:</span> <span class="token punctuation">{</span>
                flexbox<span class="token operator">:</span> <span class="token string">'no-2009'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            stage<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-aspect-ratio-mini'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-px-to-viewport'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            viewportWidth<span class="token operator">:</span> <span class="token number">750</span><span class="token punctuation">,</span> <span class="token comment">// (Number) The width of the viewport.</span>
            viewportHeight<span class="token operator">:</span> <span class="token number">1334</span><span class="token punctuation">,</span> <span class="token comment">// (Number) The height of the viewport.</span>
            unitPrecision<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// (Number) The decimal numbers to allow the REM units to grow to.</span>
            viewportUnit<span class="token operator">:</span> <span class="token string">'vw'</span><span class="token punctuation">,</span> <span class="token comment">// (String) Expected units.</span>
            selectorBlackList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.ignore'</span><span class="token punctuation">,</span> <span class="token string">'.hairlines'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// (Array) The selectors to ignore and leave as px.</span>
            minPixelValue<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// (Number) Set the minimum pixel value to replace.</span>
            mediaQuery<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// (Boolean) Allow px to be converted in media queries.</span>
            exclude<span class="token operator">:</span> <span class="token regex">/(\/|\\)(node_modules)(\/|\\)/</span> <span class="token comment">// æ’é™¤node_modulesæ–‡ä»¶ä¸­ç¬¬ä¸‰æ–¹cssæ–‡ä»¶</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-write-svg'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            utf8<span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-viewport-units'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token function-variable function">filterRule</span><span class="token operator">:</span> <span class="token parameter">rule</span> <span class="token operator">=&gt;</span> rule<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=&gt;</span> i<span class="token punctuation">.</span>prop <span class="token operator">===</span> <span class="token string">'content'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">// è¿‡æ»¤ä¼ªç±»contentä½¿ç”¨</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            preset<span class="token operator">:</span> <span class="token string">&quot;advanced&quot;</span><span class="token punctuation">,</span>
            autoprefixer<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token string">&quot;postcss-zindex&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="vwå…¼å®¹æ–¹æ¡ˆ"><a href="#vwå…¼å®¹æ–¹æ¡ˆ" class="header-anchor">#</a> vwå…¼å®¹æ–¹æ¡ˆ</h3> <p>ä½¿ç”¨<code>viewport</code>çš„<code>polyfill</code>ï¼š<a href="https://github.com/rodneyrehm/viewport-units-buggyfill" target="_blank" rel="noopener noreferrer">Viewport Units Buggyfill<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚ä½¿ç”¨<code>viewport-units-buggyfill</code>ä¸»è¦åˆ†ä»¥ä¸‹å‡ æ­¥èµ°ï¼š</p> <p>ç¬¬ä¸€æ­¥ï¼Œå¼•å…¥JavaScriptæ–‡ä»¶</p> <p><code>viewport-units-buggyfill</code>ä¸»è¦æœ‰ä¸¤ä¸ªJavaScriptæ–‡ä»¶ï¼š<code>viewport-units-buggyfill.js</code>å’Œ<code>viewport-units-buggyfill.hacks.js</code>ã€‚ä½ åªéœ€è¦åœ¨ä½ çš„HTMLæ–‡ä»¶ä¸­å¼•å…¥è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//g.alicdn.com/fdilab/lib3rd/viewport-units-buggyfill/0.6.2/??viewport-units-buggyfill.hacks.min.js,viewport-units-buggyfill.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ç¬¬äºŒæ­¥ï¼Œåœ¨HTMLæ–‡ä»¶ä¸­è°ƒç”¨<code>viewport-units-buggyfill</code>ï¼Œæ¯”å¦‚ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>viewportUnitsBuggyfill<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            hacks<span class="token operator">:</span> window<span class="token punctuation">.</span>viewportUnitsBuggyfillHacks
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="æˆ–è€…"><a href="#æˆ–è€…" class="header-anchor">#</a> æˆ–è€…</h4> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> viewport-units-buggyfill
</code></pre></div><p>åœ¨<code>src/utils</code>å·¥å…·æ–‡ä»¶å¤¹ä¸‹æ·»åŠ  <code>vw.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> hacks <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'viewport-units-buggyfill/viewport-units-buggyfill.hacks'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> viewportUnitsBuggyfill <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'viewport-units-buggyfill'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
viewportUnitsBuggyfill<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    hacks<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç„¶åï¼Œåœ¨<code>src/index.js</code>ä¸­å¼•ç”¨</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'./utils/vw'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="setupproxy"><a href="#setupproxy" class="header-anchor">#</a> setupProxy</h2> <h3 id="å®‰è£…-http-proxy-middleware"><a href="#å®‰è£…-http-proxy-middleware" class="header-anchor">#</a> å®‰è£… <code>http-proxy-middleware</code></h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> http-proxy-middleware
</code></pre></div><h3 id="é…ç½®ä»£ç†"><a href="#é…ç½®ä»£ç†" class="header-anchor">#</a> é…ç½®ä»£ç†</h3> <p>åœ¨<code>src</code>ä¸‹å»ºç«‹<code>setupProxy.js</code>æ–‡ä»¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> createProxyMiddleware <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-proxy-middleware'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
        <span class="token function">createProxyMiddleware</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            target<span class="token operator">:</span> <span class="token string">'https://www.v2ex.com'</span><span class="token punctuation">,</span>
            changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// needed for virtual hosted sites</span>
            pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="api"><a href="#api" class="header-anchor">#</a> Api</h2> <p><code>src</code>ç›®å½•ä¸‹æ–°å»ºï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>src
â”œâ”€â”€ api
â”‚   â”œâ”€â”€ api.js
â”‚   â””â”€â”€ server.js

</code></pre></div><h3 id="æ¥å£"><a href="#æ¥å£" class="header-anchor">#</a> æ¥å£</h3> <p>é›†ä¸­ç®¡ç†apiæ¥å£, <code>src/api/api.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Server <span class="token keyword">from</span> <span class="token string">'./server'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">API</span> <span class="token keyword">extends</span> <span class="token class-name">Server</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   *  ç”¨é€”ï¼šæœ€çƒ­ä¸»é¢˜
   *  @url https://www.v2ex.com/api/topics/hot.json
   *  è¿”å›statusä¸º1è¡¨ç¤ºæˆåŠŸ
   *  @method get
   *  @return {promise}
   */</span>
  <span class="token keyword">async</span> <span class="token function">getHot</span><span class="token punctuation">(</span><span class="token parameter">params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">axios</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'/api/topics/hot.json'</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">||</span> result<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> err <span class="token operator">=</span> <span class="token punctuation">{</span>
          tip<span class="token operator">:</span> <span class="token string">'è·å–æœ€çƒ­ä¸»é¢˜å¤±è´¥'</span><span class="token punctuation">,</span>
          response<span class="token operator">:</span> result<span class="token punctuation">,</span>
          data<span class="token operator">:</span> params<span class="token punctuation">,</span>
          url<span class="token operator">:</span> <span class="token string">'//www.v2ex.com/api/topics/hot.json'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">API</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="axioså°è£…"><a href="#axioså°è£…" class="header-anchor">#</a> axioså°è£…</h3> <p><code>src/api/server.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> envconfig <span class="token keyword">from</span> <span class="token string">'@/envconfig/envconfig'</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * ä¸»è¦paramså‚æ•°
 * @params method {string} æ–¹æ³•å
 * @params url {string} è¯·æ±‚åœ°å€  ä¾‹å¦‚ï¼š/login é…åˆbaseURLç»„æˆå®Œæ•´è¯·æ±‚åœ°å€
 * @params baseURL {string} è¯·æ±‚åœ°å€ç»Ÿä¸€å‰ç¼€ ***éœ€è¦æå‰æŒ‡å®š***  ä¾‹å¦‚ï¼šhttp://cangdu.org
 * @params timeout {number} è¯·æ±‚è¶…æ—¶æ—¶é—´ é»˜è®¤ 30000
 * @params params {object}  getæ–¹å¼ä¼ å‚keyå€¼
 * @params headers {string} æŒ‡å®šè¯·æ±‚å¤´ä¿¡æ¯
 * @params withCredentials {boolean} è¯·æ±‚æ˜¯å¦æºå¸¦æœ¬åœ°cookiesä¿¡æ¯é»˜è®¤å¼€å¯
 * @params validateStatus {func} é»˜è®¤åˆ¤æ–­è¯·æ±‚æˆåŠŸçš„èŒƒå›´ 200 - 300
 * @return {Promise}
 * å…¶ä»–æ›´å¤šæ‹“å±•å‚çœ‹axiosæ–‡æ¡£å è‡ªè¡Œæ‹“å±•
 * æ³¨æ„ï¼šparamsä¸­çš„æ•°æ®ä¼šè¦†ç›–method url å‚æ•°ï¼Œæ‰€ä»¥å¦‚æœæŒ‡å®šäº†è¿™2ä¸ªå‚æ•°åˆ™ä¸éœ€è¦åœ¨paramsä¸­å¸¦å…¥
*/</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>
  <span class="token function">axios</span><span class="token punctuation">(</span><span class="token parameter">method<span class="token punctuation">,</span> url<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> params <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> _option <span class="token operator">=</span> params<span class="token punctuation">;</span>
      _option <span class="token operator">=</span> <span class="token punctuation">{</span>
        method<span class="token punctuation">,</span>
        url<span class="token punctuation">,</span>
        baseURL<span class="token operator">:</span> envconfig<span class="token punctuation">.</span>baseURL<span class="token punctuation">,</span>
        timeout<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
        params<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        headers<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        withCredentials<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//æ˜¯å¦æºå¸¦cookieså‘èµ·è¯·æ±‚</span>
        <span class="token function-variable function">validateStatus</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>params<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      axios<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>_option<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> res<span class="token punctuation">.</span>data <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span> res<span class="token punctuation">.</span>data <span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>src/envconfig/envconfig.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * å…¨å±€é…ç½®æ–‡ä»¶
 */</span>
<span class="token keyword">let</span> baseURL<span class="token punctuation">;</span> 
<span class="token keyword">let</span> imgUrl <span class="token operator">=</span> <span class="token string">'//www.v2ex.com'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  baseURL <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  baseURL <span class="token operator">=</span> <span class="token string">'//www.v2ex.com'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>imgUrl<span class="token punctuation">,</span> baseURL<span class="token punctuation">}</span>

</code></pre></div><h2 id="ä½¿ç”¨-router-è·¯ç”±"><a href="#ä½¿ç”¨-router-è·¯ç”±" class="header-anchor">#</a> ä½¿ç”¨ Router(è·¯ç”±)</h2> <h3 id="å®‰è£…-3"><a href="#å®‰è£…-3" class="header-anchor">#</a> å®‰è£…</h3> <p>å®‰è£… <code>react-router-dom</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> react-router-dom
<span class="token comment"># or</span>
<span class="token function">yarn</span> <span class="token function">add</span> react-router-dom
</code></pre></div><h3 id="åŸºæœ¬åº”ç”¨-2"><a href="#åŸºæœ¬åº”ç”¨-2" class="header-anchor">#</a> åŸºæœ¬åº”ç”¨</h3> <p><code>src</code>ç›®å½•ä¸‹åˆ›å»º<code>router</code>æ–‡ä»¶å¤¹ï¼Œ<code>router</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»º<code>index.js</code></p> <div class="language- extra-class"><pre class="language-text"><code>src
â”œâ”€â”€ router
â”‚   â””â”€â”€ index.js

</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter<span class="token punctuation">,</span> Switch<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Redirect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> asyncComponent <span class="token keyword">from</span> <span class="token string">'@/utils/asyncComponent'</span><span class="token punctuation">;</span>

<span class="token comment">// import home from &quot;@/pages/home/home&quot;;</span>
<span class="token keyword">const</span> home <span class="token operator">=</span> <span class="token function">asyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/pages/home/home&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> detail <span class="token operator">=</span> <span class="token function">asyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/pages/detail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token function">asyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/pages/list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// react-router4 ä¸å†æ¨èå°†æ‰€æœ‰è·¯ç”±è§„åˆ™æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹é›†ä¸­å¼è·¯ç”±ï¼Œå­è·¯ç”±åº”è¯¥ç”±çˆ¶ç»„ä»¶åŠ¨æ€é…ç½®ï¼Œç»„ä»¶åœ¨å“ªé‡ŒåŒ¹é…å°±åœ¨å“ªé‡Œæ¸²æŸ“ï¼Œæ›´åŠ çµæ´»</span>
<span class="token keyword">class</span> <span class="token class-name">RouteConfig</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">BrowserRouter</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Switch</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">exact</span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>home<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/detail<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>detail<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Redirect</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Switch</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">BrowserRouter</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> RouteConfig
</code></pre></div><p>è¿™é‡Œæœ‰ä¸€ä¸ªå®ç°æŒ‰éœ€åŠ è½½çš„å·¥å…· <code>asyncComponent.jsx</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// asyncComponent.jsx</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">asyncComponent</span><span class="token punctuation">(</span><span class="token parameter">importComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">AsyncComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
        component<span class="token operator">:</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> component <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">importComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>component<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>component<span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token constant">C</span> <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">C</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">this</span><span class="token punctuation">.</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> AsyncComponent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ·»åŠ åˆ° <code>src/index.js</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Route <span class="token keyword">from</span> <span class="token string">'./router/'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FastClick <span class="token keyword">from</span> <span class="token string">'fastclick'</span><span class="token punctuation">;</span>

FastClick<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token parameter">Component</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span>Route<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Webpack Hot Module Replacement API</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">'./router/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span>Route<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// If you want your app to work offline and load faster, you can change</span>
<span class="token comment">// unregister() to register() below. Note this comes with some pitfalls.</span>
<span class="token comment">// Learn more about service workers: https://bit.ly/CRA-PWA</span>
serviceWorker<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="ä½¿ç”¨-redux-çŠ¶æ€ç®¡ç†"><a href="#ä½¿ç”¨-redux-çŠ¶æ€ç®¡ç†" class="header-anchor">#</a> ä½¿ç”¨ Redux(çŠ¶æ€ç®¡ç†)</h2> <p>Redux æ˜¯ JavaScript çŠ¶æ€å®¹å™¨ï¼Œæä¾›å¯é¢„æµ‹åŒ–çš„çŠ¶æ€ç®¡ç†ã€‚</p> <h3 id="å®‰è£…-4"><a href="#å®‰è£…-4" class="header-anchor">#</a> å®‰è£…</h3> <p>å®‰è£…ç¨³å®šç‰ˆ</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> --save redux 
</code></pre></div><p>å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ è¿˜éœ€è¦ä½¿ç”¨ React ç»‘å®šåº“å’Œå¼€å‘è€…å·¥å…·ã€‚</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> --save react-redux  
<span class="token function">npm</span> <span class="token function">install</span> --save-dev redux-devtools  
</code></pre></div><h3 id="åŸºæœ¬åº”ç”¨-3"><a href="#åŸºæœ¬åº”ç”¨-3" class="header-anchor">#</a> åŸºæœ¬åº”ç”¨</h3> <p><code>src</code>ç›®å½•ä¸‹åˆ›å»º<code>store</code>æ–‡ä»¶å¤¹ï¼Œ<code>store</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»º<code>store.js</code></p> <div class="language- extra-class"><pre class="language-text"><code>src
â””â”€â”€ store
   â”œâ”€â”€ home
   â”‚     â”œâ”€â”€ action.js
   â”‚     â”œâ”€â”€ action-type.js
   â”‚     â””â”€â”€ reducer.js
   â””â”€â”€ store.js

</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">,</span> combineReducers<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> compose<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> home <span class="token keyword">from</span> <span class="token string">'./home/reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> production <span class="token keyword">from</span> <span class="token string">'./production/reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'redux-thunk'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> composeEnhancers <span class="token operator">=</span>
  <span class="token keyword">typeof</span> window <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span>
  window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ <span class="token operator">?</span>   
    window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// Specify extensionâ€™s options like name, actionsBlacklist, actionsCreators, serialize...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">:</span> compose<span class="token punctuation">;</span>

<span class="token keyword">const</span> enhancer <span class="token operator">=</span> <span class="token function">composeEnhancers</span><span class="token punctuation">(</span>
  <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// other store enhancers if any</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
  <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span>home<span class="token punctuation">,</span> <span class="token operator">...</span>production<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  enhancer
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>

</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// action.js</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> home <span class="token keyword">from</span> <span class="token string">'./action-type'</span><span class="token punctuation">;</span>
<span class="token comment">// ä¿å­˜åˆ—è¡¨æ•°æ®</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">saveList</span> <span class="token operator">=</span> <span class="token parameter">list</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> home<span class="token punctuation">.</span><span class="token constant">SAVELIST</span><span class="token punctuation">,</span>
    list
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// è¯·å®¢æ•°æ®</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">clearData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> home<span class="token punctuation">.</span><span class="token constant">CLEARDATA</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// action-type.js</span>
<span class="token comment">// ä¿å­˜åˆ—è¡¨æ•°æ®</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SAVELIST</span> <span class="token operator">=</span> <span class="token string">'SAVELIST'</span><span class="token punctuation">;</span>
<span class="token comment">// æ¸…ç©ºæ•°æ®</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">CLEARDATA</span> <span class="token operator">=</span> <span class="token string">'CLEARDATA'</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// reducer.js</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> home <span class="token keyword">from</span> <span class="token string">'./action-type'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
  list<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//ä¸»é¢˜åˆ—è¡¨</span>
<span class="token punctuation">}</span>
<span class="token comment">// é¦–é¡µè¡¨å•æ•°æ®</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">list</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState <span class="token punctuation">,</span> action <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> home<span class="token punctuation">.</span><span class="token constant">SAVELIST</span><span class="token operator">:</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">{</span>list<span class="token operator">:</span> action<span class="token punctuation">.</span>list<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> home<span class="token punctuation">.</span><span class="token constant">CLEARDATA</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>defaultState<span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>æ·»åŠ åˆ° <code>src/index.js</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Route <span class="token keyword">from</span> <span class="token string">'./router/'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FastClick <span class="token keyword">from</span> <span class="token string">'fastclick'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> serviceWorker <span class="token keyword">from</span> <span class="token string">'./serviceWorker'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppContainer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-hot-loader'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'@/store/store'</span><span class="token punctuation">;</span>
<span class="token comment">// import './utils/setRem';</span>
<span class="token keyword">import</span> <span class="token string">'./utils/vw'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'./style/base.css'</span><span class="token punctuation">;</span>

FastClick<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç›‘å¬stateå˜åŒ–</span>
<span class="token comment">// store.subscribe(() =&gt; {</span>
<span class="token comment">//   console.log('storeå‘ç”Ÿäº†å˜åŒ–');</span>
<span class="token comment">// });</span>

<span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token parameter">Component</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token comment">//ç»‘å®šreduxã€çƒ­åŠ è½½</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Provider</span></span> <span class="token attr-name">store</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AppContainer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">AppContainer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Provider</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span>Route<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Webpack Hot Module Replacement API</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">'./router/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span>Route<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// If you want your app to work offline and load faster, you can change</span>
<span class="token comment">// unregister() to register() below. Note this comes with some pitfalls.</span>
<span class="token comment">// Learn more about service workers: https://bit.ly/CRA-PWA</span>
serviceWorker<span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><code>React-redux</code>ä½¿ç”¨ï¼Œ<code>connect</code></p> <div class="language-jsx extra-class"><div class="highlight-lines"><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br></div><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token constant">API</span> <span class="token keyword">from</span> <span class="token string">'@/api/api'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> saveList<span class="token punctuation">,</span> clearData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/store/home/action'</span><span class="token punctuation">;</span>
<span class="token comment">// import PropTypes from 'prop-types';</span>
<span class="token keyword">import</span> <span class="token string">'./home.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd-mobile'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">999</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentDidMount'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">getHot</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">API</span><span class="token punctuation">.</span><span class="token function">getHot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>t<span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log(result)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">saveList</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">goList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      pathname<span class="token operator">:</span> <span class="token string">'/list'</span><span class="token punctuation">,</span>
      query<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      state<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>home-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Home-</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* &lt;Button&gt;&lt;/Button&gt; */</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
  list<span class="token operator">:</span> state
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  saveList<span class="token punctuation">,</span> 
  clearData<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="æœ€å"><a href="#æœ€å" class="header-anchor">#</a> æœ€å ğŸ“Œ</h2> <p>ğŸ¶ å¼€å§‹å¿«ä¹çš„å†™é¡µé¢å§ï¼</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/20/2021, 11:12:15 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/dist/assets/js/app.c45fc4d8.js" defer></script><script src="/dist/assets/js/2.7c6cafdd.js" defer></script><script src="/dist/assets/js/5.60462f69.js" defer></script>
  </body>
</html>
